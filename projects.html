<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Material Design Lite -->
    <script src="mdl/material.min.js"></script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- MDL -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="mdl/material.min.css">
    <!-- Custome css -->
    <link rel="stylesheet" type="text/css" href="card.css">
    <link rel="stylesheet" type="text/css" href="header.css">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Erik Karlkvist</title>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <!-- Title -->
          <span class="mdl-layout-title">
            <h2><a class="page_title" font-size="20px" href="index.html">Erik Karlkvist</a></h2>
          </span>
          <!-- Add spacer, to align navigation to the right -->
          <div class="mdl-layout-spacer"></div>
          <!-- Navigation. We hide it in small screens. -->
          <nav class="mdl-navigation mdl-layout--large-screen-only">
            <a class="mdl-navigation__link" href="">About me</a>
            <a class="mdl-navigation__link" href="projects.html"><b> Projects </b></a>
            <a class="mdl-navigation__link" href="blog.html">Blog</a>
            <a class="mdl-navigation__link" href="https://github.com/ErikKarlkvist">Github</a>
            <a class="mdl-navigation__link" href="https://www.linkedin.com/in/erik-karlkvist-16329b114?trk=nav_responsive_tab_profile">LinkedIn</a>
          </nav>
        </div>
        <div class="mdl-grid">

        </div>
      </header>
      <div class="mdl-layout__drawer mdl-layout--small-screen-only">
        <span class="mdl-layout-title">Erik Karlkvist</span>
        <nav class="mdl-navigation ">
          <a class="mdl-navigation__link" href="">About me</a>
          <a class="mdl-navigation__link active_tab" href="projects.html">Projects</a>
          <a class="mdl-navigation__link" href="blog.html">Blog</a>
          <a class="mdl-navigation__link" href="https://github.com/ErikKarlkvist">Github</a>
          <a class="mdl-navigation__link" href="https://www.linkedin.com/in/erik-karlkvist-16329b114?trk=nav_responsive_tab_profile">LinkedIn</a>
        </nav>
      </div>
      <main class="mdl-layout__content">
        <div class= "mdl-grid">
          <div class="project_blog-card mdl-card mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-shadow--2dp">

            <div class="mdl-card__title" >
              <h1 class="mdl-card__title-text">Snake game using Haste and Haskell</h1>
            </div>
            <div class = "mdl-grid">
              <div class ="mdl-card mdl-cell mdl-cell--5-col mdl-cell--5-col-tablet">
                <object type="text/html" data="projects/MainHaste.html" width="800px" height="450px" style="overflow:auto;"></object>
              </div>
              <div class ="mdl-card mdl-cell mdl-cell--6-col mdl-cell--6-col-tablet">
                <p>In the functional programming course me and Emil Axelsson created this snake game. It uses <a class="a2" href="http://haste-lang.org/">haste</a> to create the HTML elements and the snake runs in
                  <a class="a2" href="https://www.haskell.org/"> haskell</a>.</p>
                <p><b>Run the game by clicking on it and then push any arrow key to move.</b> <i>This only works on desktop computers.</i><p>
                These are some examples from the code that runs the game. The snake data is either the end of the snake or a position followed by the rest of the snake. The updateTileInGrid function
                show how any tile is updated every time the game ticks.
                  <pre>type Pos = (Int, Int)
data Snake = Add Pos Snake | End

updateTileInGrid :: Grid -> Pos -> Tile -> Grid
updateTileInGrid (Grid grid) (row, col) tile = newGrid
  where newGrid = Grid (grid !!= (row,((grid !! row) !!= (col,tile))))</pre>
                  <p>The following functions creates a picture that is painted every time the game ticks. It runs through the entire matrix of the snake game and draws rectangles or circles at the correponding positions.</p>
                  <pre>fillTiles' :: [Tile] -> Int -> Int-> Picture ()
fillTiles' [] _  _   = return ()
fillTiles' (x:xs) row col = do
    let drow = fromIntegral row
    let dcol = fromIntegral col
    case x of Empty     -> color (RGB 255 255 255) $ stroke $ rect (drow, dcol) (drow+20, dcol+20)
              SnakeBody -> color (RGB 255 0 0)     $ fill   $ circle (drow+10, dcol+10) 10
              Coin      -> color (RGB 255 215 0)   $ fill   $ circle (drow+10, dcol+10) 10
    fillTiles' xs (row+20) col</pre>
              </div>
            </div>
            <div class="mdl-card__actions mdl-card--border">
              <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect a2" href="https://github.com/emiilax/TDA452-FuncProg/tree/master/project">View source code</a>
              <div class="mdl-layout-spacer"></div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </body>
</html>
